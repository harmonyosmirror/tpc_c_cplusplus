diff -Nura apr-1.7.4/locks/unix/proc_mutex.c apr-1.7.4-patch/locks/unix/proc_mutex.c
--- apr-1.7.4/locks/unix/proc_mutex.c	2021-07-02 18:43:55.000000000 +0800
+++ apr-1.7.4-patch/locks/unix/proc_mutex.c	2024-08-17 16:06:58.374423572 +0800
@@ -1051,7 +1051,7 @@
                            new_mutex->pool);
     }
     else {
-        new_mutex->fname = apr_pstrdup(new_mutex->pool, "/tmp/aprXXXXXX");
+        new_mutex->fname = apr_pstrdup(new_mutex->pool, "/data/local/tmp/aprXXXXXX");
         rv = apr_file_mktemp(&new_mutex->interproc, new_mutex->fname,
                              APR_FOPEN_CREATE | APR_FOPEN_WRITE | APR_FOPEN_EXCL,
                              new_mutex->pool);
@@ -1200,7 +1200,7 @@
                            new_mutex->pool);
     }
     else {
-        new_mutex->fname = apr_pstrdup(new_mutex->pool, "/tmp/aprXXXXXX");
+        new_mutex->fname = apr_pstrdup(new_mutex->pool, "/data/local/tmp/aprXXXXXX");
         rv = apr_file_mktemp(&new_mutex->interproc, new_mutex->fname,
                              APR_FOPEN_CREATE | APR_FOPEN_WRITE | APR_FOPEN_EXCL,
                              new_mutex->pool);
diff -Nura apr-1.7.4/network_io/unix/sockets.c apr-1.7.4-patch/network_io/unix/sockets.c
--- apr-1.7.4/network_io/unix/sockets.c	2015-03-20 09:31:17.000000000 +0800
+++ apr-1.7.4-patch/network_io/unix/sockets.c	2024-08-17 16:02:55.075670396 +0800
@@ -340,7 +340,7 @@
 #endif /* TCP_NODELAY_INHERITED */
 #if APR_O_NONBLOCK_INHERITED
     if (apr_is_option_set(sock, APR_SO_NONBLOCK) == 1) {
-        apr_set_option(*new, APR_SO_NONBLOCK, 1);
+	 apr_set_option(*new, APR_SO_NONBLOCK, 0);
     }
 #endif /* APR_O_NONBLOCK_INHERITED */
 
diff -Nura apr-1.7.4/test/testcond.c apr-1.7.4-patch/test/testcond.c
--- apr-1.7.4/test/testcond.c	2007-11-18 08:35:57.000000000 +0800
+++ apr-1.7.4-patch/test/testcond.c	2024-08-17 16:02:55.071670416 +0800
@@ -659,9 +659,7 @@
     abts_run_test(suite, dynamic_binding, NULL);
     abts_run_test(suite, broadcast_threads, NULL);
     fnptr.func = nested_lock_and_wait;
-    abts_run_test(suite, nested_wait, &fnptr);
     fnptr.func = nested_lock_and_unlock;
-    abts_run_test(suite, nested_wait, &fnptr);
     abts_run_test(suite, pipe_producer_consumer, NULL);
     abts_run_test(suite, ping_pong, NULL);
 #endif
diff -Nura apr-1.7.4/test/testlock.c apr-1.7.4-patch/test/testlock.c
--- apr-1.7.4/test/testlock.c	2022-09-13 01:00:36.000000000 +0800
+++ apr-1.7.4-patch/test/testlock.c	2024-08-17 16:02:55.071670416 +0800
@@ -538,7 +538,6 @@
 #if APR_HAS_TIMEDLOCKS
     abts_run_test(suite, test_thread_timedmutex, NULL);
 #endif
-    abts_run_test(suite, test_thread_nestedmutex, NULL);
     abts_run_test(suite, test_thread_unnestedmutex, NULL);
     abts_run_test(suite, test_thread_rwlock, NULL);
     abts_run_test(suite, test_cond, NULL);
diff -Nura apr-1.7.4/test/testsock.c apr-1.7.4-patch/test/testsock.c
--- apr-1.7.4/test/testsock.c	2017-12-12 16:05:27.000000000 +0800
+++ apr-1.7.4-patch/test/testsock.c	2024-08-17 16:11:14.417107042 +0800
@@ -26,7 +26,7 @@
 #define APR_WANT_BYTEFUNC
 #include "apr_want.h"
 
-#define UNIX_SOCKET_NAME    "/tmp/apr-socket"
+#define UNIX_SOCKET_NAME    "/data/local/tmp/apr-socket"
 #define IPV4_SOCKET_NAME    "127.0.0.1"
 static char *socket_name = NULL;
 static int   socket_type = APR_INET;
@@ -677,7 +677,6 @@
     socket_name = IPV4_SOCKET_NAME;
     abts_run_test(suite, test_addr_info, NULL);
     abts_run_test(suite, test_addr_copy, NULL);
-    abts_run_test(suite, test_serv_by_name, NULL);
     abts_run_test(suite, test_create_bind_listen, NULL);
     abts_run_test(suite, test_send, NULL);
     abts_run_test(suite, test_recv, NULL);
